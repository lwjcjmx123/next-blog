---
title: "è‡ªå®šä¹‰ç»„ä»¶è„šæ‰‹æ¶ç³»ç»Ÿè®¾è®¡ä¸å®ç°"
slug: "custom-component-scaffold"
excerpt: "åŸºäºæ¨¡æ¿å¼•æ“çš„ç»„ä»¶è„šæ‰‹æ¶ç³»ç»Ÿï¼Œå®ç°å¿«é€Ÿç”Ÿæˆæ ‡å‡†åŒ–Vue + TSXç»„ä»¶ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡"
published: true
date: "2024-05-15"
category: "å‰ç«¯å·¥ç¨‹åŒ–"
tags: ["è„šæ‰‹æ¶", "ç»„ä»¶å¼€å‘", "è‡ªåŠ¨åŒ–", "æ¨¡æ¿å¼•æ“"]
author: "Long"
readingTime: "8åˆ†é’Ÿ"
---

## æ¦‚è¿°

åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œç»„ä»¶åŒ–æ˜¯æé«˜ä»£ç å¤ç”¨æ€§å’Œç»´æŠ¤æ€§çš„å…³é”®ã€‚è‡ªå®šä¹‰ç»„ä»¶è„šæ‰‹æ¶ç³»ç»Ÿé€šè¿‡æ ‡å‡†åŒ–çš„æ¨¡æ¿å’Œè‡ªåŠ¨åŒ–æµç¨‹ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿç”Ÿæˆç¬¦åˆå›¢é˜Ÿè§„èŒƒçš„Vue + TSXç»„ä»¶ä»£ç ã€‚

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

### 1. æ ‡å‡†åŒ–æ¨¡æ¿

- **ç»Ÿä¸€ç»“æ„**: ç¡®ä¿æ‰€æœ‰ç»„ä»¶éµå¾ªç›¸åŒçš„æ–‡ä»¶ç»„ç»‡ç»“æ„
- **æœ€ä½³å®è·µ**: å†…ç½® TypeScriptã€æµ‹è¯•ã€æ–‡æ¡£ç­‰æœ€ä½³å®è·µ
- **å¯æ‰©å±•æ€§**: æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿å’Œé…ç½®

### 2. æ™ºèƒ½ç”Ÿæˆ

- **äº¤äº’å¼é…ç½®**: é€šè¿‡å‘½ä»¤è¡Œäº¤äº’æ”¶é›†ç»„ä»¶ä¿¡æ¯
- **åŠ¨æ€æ¨¡æ¿**: æ ¹æ®é…ç½®åŠ¨æ€ç”Ÿæˆä¸åŒç±»å‹çš„ç»„ä»¶
- **ä¾èµ–ç®¡ç†**: è‡ªåŠ¨å¤„ç†ç»„ä»¶ä¾èµ–å’Œå¯¼å…¥

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„å›¾

<ArchitectureDiagram
  title="ç»„ä»¶è„šæ‰‹æ¶ç³»ç»Ÿæ¶æ„"
  layers={[
    {
      name: "CLIäº¤äº’å±‚",
      color: "#3b82f6",
      components: ["ç”¨æˆ·è¾“å…¥", "å‚æ•°éªŒè¯", "äº¤äº’é—®ç­”", "å‘½ä»¤è§£æ"],
    },
    {
      name: "è„šæ‰‹æ¶æ ¸å¿ƒ",
      color: "#8b5cf6",
      components: ["é…ç½®ç®¡ç†", "æµç¨‹æ§åˆ¶", "æ•°æ®å‡†å¤‡", "æ¨¡æ¿æ¸²æŸ“"],
    },
    {
      name: "æ¨¡æ¿å¼•æ“",
      color: "#f59e0b",
      components: ["å˜é‡æ›¿æ¢", "æ¡ä»¶æ¸²æŸ“", "å¾ªç¯å¤„ç†", "æ¨¡æ¿è§£æ"],
    },
    {
      name: "æ–‡ä»¶ç”Ÿæˆ",
      color: "#10b981",
      components: ["Vue+TSXç»„ä»¶", "æ ·å¼æ–‡ä»¶", "æµ‹è¯•æ–‡ä»¶", "æ–‡æ¡£æ–‡ä»¶"],
    },
  ]}
/>

```typescript
/**
 * Vueç»„ä»¶è„šæ‰‹æ¶æ ¸å¿ƒç±»
 * è´Ÿè´£Vue + TSXç»„ä»¶ç”Ÿæˆçš„æ•´ä¸ªæµç¨‹ç®¡ç†
 */
class VueComponentScaffold {
  constructor(config: any = {}) {
    this.config = {
      templatesDir: "./templates",
      outputDir: "./src/components",
      ...config,
    };
    this.templateEngine = new TemplateEngine();
  }

  /**
   * ç”ŸæˆVueç»„ä»¶
   * @param {Object} options - ç»„ä»¶é…ç½®é€‰é¡¹
   */
  async generateComponent(options: any) {
    // éªŒè¯é…ç½®
    this.validateOptions(options);

    // å‡†å¤‡æ¨¡æ¿æ•°æ®
    const templateData = this.prepareTemplateData(options);

    // ç”Ÿæˆæ–‡ä»¶
    await this.generateFiles(templateData);

    // åå¤„ç†
    await this.postProcess(options);

    console.log(`âœ… Vueç»„ä»¶ ${options.name} ç”ŸæˆæˆåŠŸ!`);
  }

  /**
   * å‡†å¤‡æ¨¡æ¿æ•°æ®
   */
  prepareTemplateData(options: any) {
    return {
      componentName: options.name,
      pascalName: this.toPascalCase(options.name),
      kebabName: this.toKebabCase(options.name),
      hasProps: options.props && options.props.length > 0,
      props: options.props || [],
      hasComposables: options.type === "composable",
      hasEmits: options.emits && options.emits.length > 0,
      emits: options.emits || [],
      timestamp: new Date().toISOString(),
      author: options.author || "Unknown",
    };
  }
}
```

## æ¨¡æ¿å¼•æ“å®ç°

```typescript
/**
 * ç®€åŒ–çš„æ¨¡æ¿å¼•æ“
 * æ”¯æŒå˜é‡æ›¿æ¢å’Œæ¡ä»¶æ¸²æŸ“
 */
class TemplateEngine {
  /**
   * æ¸²æŸ“æ¨¡æ¿
   * @param {string} template - æ¨¡æ¿å­—ç¬¦ä¸²
   * @param {Object} data - æ¨¡æ¿æ•°æ®
   */
  render(template: string, data: any): string {
    let result = template;

    // å˜é‡æ›¿æ¢ {{variable}}
    result = result.replace(/\{\{\s*(\w+)\s*\}\}/g, (match, key) => {
      return data[key] || "";
    });

    // æ¡ä»¶æ¸²æŸ“ {{#if condition}} ... {{/if}}
    result = result.replace(
      /\{\{#if\s+(\w+)\}\}([\s\S]*?)\{\{\/if\}\}/g,
      (match, condition, content) => {
        return data[condition] ? content : "";
      }
    );

    return result;
  }
}
```

## ç»„ä»¶æ¨¡æ¿ç¤ºä¾‹

### Vue + TSX ç»„ä»¶æ¨¡æ¿

```typescript
// templates/component.tsx.template
import { defineComponent{{#if hasComposables}}, ref{{/if}} } from 'vue';
import './{{kebabName}}.scss';

{{#if hasProps}}
interface {{pascalName}}Props {
{{#each props}}
  {{name}}: {{type}};
{{/each}}
}
{{/if}}

/**
 * {{pascalName}} ç»„ä»¶
 * @author {{author}}
 * @created {{timestamp}}
 */
export default defineComponent({
  name: '{{pascalName}}',
{{#if hasProps}}
  props: {
{{#each props}}
    {{name}}: {
      type: {{type}},
      required: true
    },
{{/each}}
  },
{{/if}}
{{#if hasEmits}}
  emits: [{{#each emits}}'{{name}}'{{#unless @last}}, {{/unless}}{{/each}}],
{{/if}}
  setup(props{{#if hasEmits}}, { emit }{{/if}}) {
{{#if hasComposables}}
    const state = ref();
{{/if}}

    return () => (
      <div class="{{kebabName}}">
        <h2>{{pascalName}} Component</h2>
{{#if hasProps}}
{{#each props}}
        <p>{{name}}: {props.{{name}}}</p>
{{/each}}
{{/if}}
      </div>
    );
  }
});
```

### æ ·å¼æ¨¡æ¿

```scss
// templates/component.scss.template
.{{kebabName}} {
  padding: 16px;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  background: #fff;
  transition: all 0.3s ease;

  &:hover {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  h2 {
    margin: 0 0 16px 0;
    color: #333;
    font-size: 1.5rem;
    font-weight: 600;
  }

  p {
    margin: 8px 0;
    color: #666;
    line-height: 1.5;
  }
}
```

## CLI äº¤äº’ç•Œé¢

```typescript
/**
 * Vueç»„ä»¶å‘½ä»¤è¡Œäº¤äº’ç•Œé¢
 */
class VueComponentCLI {
  async run() {
    console.log("ğŸš€ Vueç»„ä»¶è„šæ‰‹æ¶ç”Ÿæˆå™¨");

    const answers = await this.promptQuestions();
    const scaffold = new VueComponentScaffold();

    await scaffold.generateComponent(answers);
  }

  /**
   * äº¤äº’å¼é—®é¢˜æ”¶é›†
   */
  async promptQuestions() {
    const inquirer = require("inquirer");

    return await inquirer.prompt([
      {
        type: "input",
        name: "name",
        message: "ç»„ä»¶åç§°:",
        validate: (input: string) => {
          if (!input.trim()) return "ç»„ä»¶åç§°ä¸èƒ½ä¸ºç©º";
          if (!/^[A-Za-z][A-Za-z0-9]*$/.test(input)) {
            return "ç»„ä»¶åç§°å¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œåªèƒ½åŒ…å«å­—æ¯å’Œæ•°å­—";
          }
          return true;
        },
      },
      {
        type: "list",
        name: "type",
        message: "ç»„ä»¶ç±»å‹:",
        choices: [
          { name: "åŸºç¡€ç»„ä»¶", value: "basic" },
          { name: "ç»„åˆå¼ç»„ä»¶", value: "composable" },
          { name: "è¡¨å•ç»„ä»¶", value: "form" },
          { name: "ä¸šåŠ¡ç»„ä»¶", value: "business" },
        ],
      },
      {
        type: "confirm",
        name: "includeTests",
        message: "æ˜¯å¦ç”Ÿæˆæµ‹è¯•æ–‡ä»¶?",
        default: true,
      },
      {
        type: "confirm",
        name: "includeStorybook",
        message: "æ˜¯å¦ç”ŸæˆStorybookæ–‡æ¡£?",
        default: false,
      },
    ]);
  }
}
```

## ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ç”¨æ³•

```bash
# å®‰è£…è„šæ‰‹æ¶å·¥å…·
npm install -g @company/vue-component-scaffold

# ç”ŸæˆVueç»„ä»¶
vue-component-scaffold create

# æˆ–ç›´æ¥æŒ‡å®šå‚æ•°
vue-component-scaffold create --name UserCard --type composable --props
```

### ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„

```
src/components/UserCard/
â”œâ”€â”€ index.ts                 # å¯¼å‡ºæ–‡ä»¶
â”œâ”€â”€ UserCard.tsx            # Vue + TSXç»„ä»¶ä¸»æ–‡ä»¶
â”œâ”€â”€ UserCard.scss           # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ UserCard.test.ts        # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ UserCard.stories.ts     # Storybookæ–‡æ¡£
â””â”€â”€ types.ts                # ç±»å‹å®šä¹‰æ–‡ä»¶
```

## é…ç½®æ–‡ä»¶

```json
// vue-scaffold.config.json
{
  "templatesDir": "./templates",
  "outputDir": "./src/components",
  "defaultAuthor": "è”šæ¥å‰ç«¯å›¢é˜Ÿ",
  "styleExtension": "scss",
  "testFramework": "vitest",
  "framework": "vue3",
  "typescript": true,
  "customTemplates": {
    "modal": "./custom-templates/modal",
    "form": "./custom-templates/form",
    "table": "./custom-templates/table"
  },
  "hooks": {
    "postGenerate": "npm run lint:fix && npm run type-check"
  }
}
```

## æ ¸å¿ƒä¼˜åŠ¿

### 1. æå‡å¼€å‘æ•ˆç‡

- **å¿«é€Ÿç”Ÿæˆ**: å‡ ç§’é’Ÿå†…ç”Ÿæˆå®Œæ•´çš„Vue + TSXç»„ä»¶ç»“æ„
- **å‡å°‘é‡å¤**: é¿å…æ‰‹åŠ¨åˆ›å»ºç›¸åŒçš„æ–‡ä»¶ç»“æ„å’Œæ ·æ¿ä»£ç 
- **æ ‡å‡†åŒ–**: ç¡®ä¿å›¢é˜ŸVueç»„ä»¶ä»£ç é£æ ¼ä¸€è‡´

### 2. è´¨é‡ä¿è¯

- **æœ€ä½³å®è·µ**: å†…ç½® Vue 3 Composition APIã€TypeScriptã€Vitest æµ‹è¯•ç­‰æœ€ä½³å®è·µ
- **é”™è¯¯é¢„é˜²**: é€šè¿‡æ¨¡æ¿å‡å°‘å¸¸è§Vueç»„ä»¶ç¼–ç é”™è¯¯
- **æ–‡æ¡£å®Œæ•´**: è‡ªåŠ¨ç”Ÿæˆç»„ä»¶æ–‡æ¡£å’ŒStorybookç¤ºä¾‹

### 3. å¯æ‰©å±•æ€§

- **è‡ªå®šä¹‰æ¨¡æ¿**: æ”¯æŒå›¢é˜Ÿç‰¹å®šçš„Vueç»„ä»¶æ¨¡æ¿
- **æ’ä»¶ç³»ç»Ÿ**: å¯æ‰©å±•çš„é’©å­å’Œæ’ä»¶æœºåˆ¶
- **é…ç½®çµæ´»**: ä¸°å¯Œçš„é…ç½®é€‰é¡¹æ»¡è¶³ä¸åŒVueé¡¹ç›®éœ€æ±‚

## æ€»ç»“

è‡ªå®šä¹‰Vueç»„ä»¶è„šæ‰‹æ¶ç³»ç»Ÿé€šè¿‡æ ‡å‡†åŒ–æ¨¡æ¿å’Œè‡ªåŠ¨åŒ–æµç¨‹ï¼Œæ˜¾è‘—æå‡äº†Vue + TSXç»„ä»¶å¼€å‘æ•ˆç‡å’Œä»£ç è´¨é‡ã€‚å®ƒä¸ä»…å‡å°‘äº†é‡å¤æ€§å·¥ä½œï¼Œè¿˜ç¡®ä¿äº†å›¢é˜ŸVueä»£ç çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡å’Œçµæ´»çš„é…ç½®æœºåˆ¶ï¼Œè¯¥ç³»ç»Ÿèƒ½å¤Ÿé€‚åº”ä¸åŒVueé¡¹ç›®å›¢é˜Ÿçš„å¼€å‘éœ€æ±‚ï¼Œç‰¹åˆ«é€‚åˆè”šæ¥æ±½è½¦è¿™æ ·ä½¿ç”¨Vue 3 + TypeScriptæŠ€æœ¯æ ˆçš„å›¢é˜Ÿï¼Œæ˜¯ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„é‡è¦å·¥å…·ã€‚
